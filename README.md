# Телеграм-бот для отслеживания скидок Веб-скрейпер парсер proshoper.ru

Этот репозиторий содержит телеграм-бота, который отслеживает и предоставляет информацию о скидках из двух популярных российских сетей супермаркетов: Пятерочка и Магнит. Бот парсит данные с соответствующих веб-сайтов и представляет их пользователям через Телеграм.

## Возможности

- Парсит и отображает информацию о скидках из Пятерочки и Магнита.
- Позволяет пользователям выбирать конкретные разделы внутри магазинов.
- Рассчитывает и отображает процент скидки.
- Предоставляет период действия скидок.
- Использует встроенную клавиатуру Телеграм для удобной навигации.

## Требования

- Python 3.7+
- `requests`
- `beautifulsoup4`
- `python-telegram-bot`

## Установка

1. Клонируйте репозиторий:
    ```bash
    git clone https://github.com/yourusername/telegram-discount-bot.git
    cd telegram-discount-bot
    ```

2. Установите необходимые пакеты:
    ```bash
    pip install -r requirements.txt
    ```

3. Установите ваш токен телеграм-бота в коде:
    ```python
    TELEGRAM_BOT_TOKEN = 'YOUR_TELEGRAM_BOT_TOKEN'
    ```

4. Запустите бота:
    ```bash
    python bot.py
    ```

## Как использовать

1. Запустите бота, отправив команду `/start` в вашем приложении Телеграм.
2. Выберите "5ка" (Пятерочка) или "Магнит" для получения скидок.
3. Выберите конкретный раздел внутри выбранного магазина.
4. Бот отобразит лучшие скидки в выбранном разделе, а также периоды и проценты скидок.

## Обзор кода

- **URLS**: URL-адреса для страниц скидок Пятерочки и Магнита.
- **parse_price(price_str)**: Парсит строку с ценой в числовое значение.
- **format_price(price_str)**: Форматирует строку с ценой.
- **calculate_discount_percentage(original_price, discounted_price)**: Рассчитывает процент скидки.
- **get_discount_period(soup)**: Получает период действия скидки с веб-страницы.
- **split_message(message, max_length=4096)**: Разбивает длинные сообщения на части, подходящие для Телеграм.
- **get_sections(url)**: Получает разделы со страницы скидок магазина.
- **clear_bot_messages(update, context)**: Очищает все сообщения бота в чате.
- **start(update, context)**: Обрабатывает команду `/start`.
- **handle_store_selection(update, context)**: Обрабатывает выбор магазина.
- **handle_section_selection(update, context)**: Обрабатывает выбор раздела.
- **handle_back_to_store_selection(update, context)**: Обрабатывает возврат к выбору магазина.
- **main()**: Основная функция для запуска бота.
